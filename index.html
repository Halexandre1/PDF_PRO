# Revisão rápida da sua versão

**Status de execução:** está rodando bem, mas há dois pontos a corrigir para ficar redondo:

1. **Reordenar páginas (bug de índice):** ao arrastar da posição **i** para uma posição **maior** (**j**), você remove antes de inserir e isso desloca o índice alvo em −1. Sem ajustar, a página pode parar no lugar errado.
2. **Miniaturas em telas retina:** renderiza fixo em `scale: 0.4` sem considerar `devicePixelRatio`, deixando thumbs borradas em monitores de alta densidade.

**Melhorias menores (não obrigatórias):**

* `URL.revokeObjectURL` logo após o clique pode ocorrer antes do download iniciar em alguns navegadores; use `setTimeout(0)` por segurança.
* A11y: permitir seleção com **Enter/Espaço** nas miniaturas; fechar modal com **Esc**; `role="dialog"`, `aria-modal`.
* Tema: manter ícone ☀️/🌙 sincronizado no load (você já faz, mantive).

---

## O que eu entrego abaixo

1. **Patch completo** (HTML único) com:

   * **Correção do reordenamento** (ajuste de índice pós-remoção).
   * **Thumbs nítidas** com `devicePixelRatio` e largura alvo.
   * **Acessibilidade** (teclado + atributos ARIA) e fechamento do modal com Esc/overlay.
   * **Gerenciador de logo**: botão “Trocar logo” (upload), **persistência em localStorage**, botão “Remover logo”, e aplicação automática em tema claro/escuro. Também atualizo o **favicon** com o logo.

> Basta **substituir** seu arquivo por este.

```html
<!DOCTYPE html>
<html lang="pt-BR" class="">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Editor de PDF PRO</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  <link id="dynamicFavicon" rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%234f46e5'/%3E%3Ctext x='50' y='58' font-size='52' text-anchor='middle' fill='white' font-family='Inter'%3EP%3C/text%3E%3C/svg%3E" />
  <style>
    :root { --accent-color:#4f46e5; }
    body{font-family:'Inter',sans-serif;transition:background-color .3s,color .3s}
    .pdf-page.selected{border-color:var(--accent-color);box-shadow:0 0 0 3px rgba(79,70,229,.5)}
    .pdf-container-wrapper::-webkit-scrollbar{display:none}
    .pdf-container-wrapper{-ms-overflow-style:none;scrollbar-width:none}
    .loader{border-right-color:transparent!important;animation:spin 1s linear infinite}
    @keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
    .pdf-page.dragging{opacity:.5;cursor:grabbing}
    .pdf-page.drag-over{box-shadow:0 0 0 4px var(--accent-color)}
    .drop-zone-highlight{border-color:var(--accent-color)!important;box-shadow:0 0 0 4px rgba(79,70,229,.5)!important}
  </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 font-sans bg-slate-100 dark:bg-slate-900 text-slate-900 dark:text-slate-200">

  <div class="bg-white dark:bg-slate-800 p-6 rounded-lg shadow-xl w-full max-w-5xl">
    <header class="flex flex-wrap justify-between items-center gap-4 mb-4">
      <div class="flex items-center gap-4">
        <img id="appLogo" src="https://placehold.co/56x56/4f46e5/ffffff?text=LOGO" alt="Logo" class="w-14 h-14 rounded-md object-contain bg-white/50 dark:bg-slate-700/50 p-1" />
        <div>
          <h1 class="text-3xl font-bold text-indigo-700 dark:text-indigo-400">Editor de PDF PRO</h1>
          <p class="text-gray-600 dark:text-gray-400">Importe, junte, substitua, gire, reordene e salve os seus PDFs com facilidade.</p>
        </div>
      </div>
      <div class="flex items-center gap-2">
        <input id="logoInput" type="file" accept="image/*" class="hidden" />
        <button id="changeLogoBtn" type="button" class="px-3 py-2 rounded-lg bg-slate-200 hover:bg-slate-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-sm">Trocar logo</button>
        <button id="clearLogoBtn" type="button" class="px-3 py-2 rounded-lg bg-slate-200 hover:bg-slate-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-sm">Remover logo</button>
        <button id="themeToggle" class="w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 flex items-center justify-center transition-transform hover:scale-110" aria-label="Alternar tema" title="Tema">🌙</button>
      </div>
    </header>

    <section class="mb-6">
      <label for="importInput" class="cursor-pointer bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition w-full flex items-center justify-center gap-2">
        <i class="fas fa-file-import"></i> Importar PDF(s)
        <input type="file" id="importInput" accept=".pdf" class="hidden" multiple />
      </label>
    </section>

    <section class="flex flex-wrap items-center justify-center gap-4 mb-6 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg">
      <button id="replaceButton" class="flex items-center justify-center bg-orange-500 hover:bg-orange-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition disabled:opacity-50" disabled><i class="fas fa-exchange-alt mr-2"></i> Substituir</button>
      <button id="rotateClockwiseButton" class="flex items-center justify-center bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition disabled:opacity-50" disabled><i class="fas fa-redo-alt mr-2"></i> Girar 90°</button>
      <button id="rotateCounterClockwiseButton" class="flex items-center justify-center bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition disabled:opacity-50" disabled><i class="fas fa-undo-alt mr-2"></i> Girar -90°</button>
      <button id="removeButton" class="flex items-center justify-center bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition disabled:opacity-50" disabled><i class="fas fa-trash-alt mr-2"></i> Remover</button>
      <button id="splitButton" class="flex items-center justify-center bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition disabled:opacity-50" disabled><i class="fas fa-cut mr-2"></i> Dividir</button>
    </section>

    <section class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-6">
      <input type="text" id="fileNameInput" placeholder="Nome do arquivo (ex: meu_documento.pdf)" class="flex-grow p-3 border border-gray-200 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-white dark:bg-slate-700" value="pdf_editado.pdf">
      <button id="downloadButton" class="flex items-center justify-center bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition disabled:opacity-50" disabled><i class="fas fa-save mr-2"></i> Salvar PDF</button>
    </section>

    <main id="pdfContainerWrapper" class="pdf-container-wrapper flex flex-wrap justify-center gap-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 min-h-[300px] max-h-[600px] overflow-y-auto transition-all" aria-live="polite">
      <p id="initialMessage" class="text-gray-500 dark:text-gray-400 text-lg self-center">Arraste e solte um ou mais PDFs aqui.</p>
      <div id="pdfContainer" class="flex flex-wrap justify-center gap-4"></div>
    </main>
    <footer id="signature" class="text-center mt-4 text-sm text-gray-500 dark:text-gray-400"></footer>
  </div>

  <!-- Modal -->
  <div id="customModal" class="fixed inset-0 bg-gray-800/75 flex items-center justify-center z-50 hidden">
    <div class="bg-white dark:bg-slate-800 p-6 rounded-lg shadow-xl max-w-sm w-full text-center border border-slate-200 dark:border-slate-700" role="dialog" aria-modal="true" aria-labelledby="modalMessage">
      <p id="modalMessage" class="text-lg font-semibold mb-4"></p>
      <button id="modalCloseButton" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg transition">OK</button>
    </div>
  </div>
  <!-- Loading -->
  <div id="loadingOverlay" class="fixed inset-0 bg-gray-800/75 flex flex-col items-center justify-center z-50 hidden" aria-live="polite" aria-busy="true">
    <div class="loader ease-linear rounded-full border-8 border-t-8 border-gray-200 h-24 w-24 mb-4" style="border-top-color:#6366f1;"></div>
    <p id="loadingMessage" class="text-white text-xl font-semibold">Carregando...</p>
  </div>

  <!-- Libs -->
  <script src="https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>

  <script>
    // Worker da PDF.js
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js';

    // DOM refs
    const DOM = {
      importInput: document.getElementById('importInput'),
      pdfContainer: document.getElementById('pdfContainer'),
      pdfContainerWrapper: document.getElementById('pdfContainerWrapper'),
      initialMessage: document.getElementById('initialMessage'),
      buttons: {
        rotateClockwise: document.getElementById('rotateClockwiseButton'),
        rotateCounterClockwise: document.getElementById('rotateCounterClockwiseButton'),
        remove: document.getElementById('removeButton'),
        split: document.getElementById('splitButton'),
        download: document.getElementById('downloadButton'),
        replace: document.getElementById('replaceButton'),
      },
      fileNameInput: document.getElementById('fileNameInput'),
      modal: {
        container: document.getElementById('customModal'),
        message: document.getElementById('modalMessage'),
        closeButton: document.getElementById('modalCloseButton')
      },
      loading: { overlay: document.getElementById('loadingOverlay'), message: document.getElementById('loadingMessage') },
      themeToggle: document.getElementById('themeToggle'),
      htmlEl: document.documentElement,
      signature: document.getElementById('signature'),
      logoImg: document.getElementById('appLogo'),
      logoInput: document.getElementById('logoInput'),
      changeLogoBtn: document.getElementById('changeLogoBtn'),
      clearLogoBtn: document.getElementById('clearLogoBtn'),
      favicon: document.getElementById('dynamicFavicon'),
    };

    // Estado
    const appState = { pdfDocOriginal:null, pdfDocLib:null, selectedPageIndices:[], draggedPageIndex:null };

    // UI helpers
    const UI = {
      showModal(msg){ DOM.modal.message.textContent = msg; DOM.modal.container.classList.remove('hidden'); },
      hideModal(){ DOM.modal.container.classList.add('hidden'); },
      showLoading(msg='Carregando...'){ DOM.loading.message.textContent = msg; DOM.loading.overlay.classList.remove('hidden'); },
      hideLoading(){ DOM.loading.overlay.classList.add('hidden'); },
      updateButtonStates(){
        const isPdfLoaded = !!appState.pdfDocLib;
        const sel = appState.selectedPageIndices.length;
        DOM.buttons.rotateClockwise.disabled = sel===0;
        DOM.buttons.rotateCounterClockwise.disabled = sel===0;
        DOM.buttons.remove.disabled = sel===0;
        DOM.buttons.split.disabled = sel===0;
        DOM.buttons.replace.disabled = sel!==1;
        DOM.buttons.download.disabled = !isPdfLoaded;
        DOM.fileNameInput.disabled = !isPdfLoaded;
      },
      async renderPDFPages(){
        if(!appState.pdfDocOriginal) return;
        DOM.pdfContainer.innerHTML='';
        appState.selectedPageIndices = [];
        const dpr = Math.max(1, Math.min(2, window.devicePixelRatio||1));
        for(let i=0;i<appState.pdfDocOriginal.numPages;i++){
          const page = await appState.pdfDocOriginal.getPage(i+1);
          const base = page.getViewport({scale:1});
          const targetWidth = 300;
          const scale = Math.min(1, targetWidth/base.width);
          const viewport = page.getViewport({scale});
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          canvas.width = Math.floor(viewport.width*dpr);
          canvas.height = Math.floor(viewport.height*dpr);
          canvas.style.width = Math.floor(viewport.width)+'px';
          canvas.style.height = Math.floor(viewport.height)+'px';
          const transform = dpr!==1 ? [dpr,0,0,dpr,0,0] : null;

          const pageDiv = document.createElement('div');
          pageDiv.className = 'pdf-page border-2 border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer m-2 inline-block transition-all hover:shadow-lg';
          pageDiv.appendChild(canvas);
          pageDiv.dataset.index=i; pageDiv.draggable=true; pageDiv.tabIndex=0; pageDiv.title = `Página ${i+1}`;

          pageDiv.addEventListener('click', EventHandlers.onPageClick);
          pageDiv.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); EventHandlers.onPageClick({currentTarget:pageDiv}); }});
          pageDiv.addEventListener('dragstart', EventHandlers.onDragStart);
          pageDiv.addEventListener('dragover', EventHandlers.onDragOver);
          pageDiv.addEventListener('dragleave', EventHandlers.onDragLeave);
          pageDiv.addEventListener('drop', EventHandlers.onDropOnPage);
          pageDiv.addEventListener('dragend', EventHandlers.onDragEnd);

          await page.render({canvasContext:ctx, viewport, transform}).promise;
          DOM.pdfContainer.appendChild(pageDiv);
        }
        UI.updateButtonStates();
      },
      loadTheme(){
        const saved = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const isDark = saved ? saved==='dark' : prefersDark;
        DOM.htmlEl.classList.toggle('dark', isDark);
        DOM.themeToggle.innerHTML = isDark ? '☀️' : '🌙';
      },
      setSignature(){ const year = new Date().getFullYear(); DOM.signature.textContent = `Feito por HAlexandre © ${year}`; },
    };

    // Operações PDF
    const PDF = {
      async updateDocs(doc){
        appState.pdfDocLib = doc;
        const bytes = await appState.pdfDocLib.save();
        appState.pdfDocOriginal = await pdfjsLib.getDocument({data: bytes.slice(0)}).promise;
        await UI.renderPDFPages();
      },
      async loadFiles(files){
        const isMerge = !!appState.pdfDocLib;
        UI.showLoading(isMerge?`Juntando ${files.length} arquivo(s)...`:`Carregando ${files.length} arquivo(s)...`);
        try{
          let currentDoc = isMerge? appState.pdfDocLib : await PDFLib.PDFDocument.create();
          for(const file of files){
            const ab = await file.arrayBuffer();
            const newDoc = await PDFLib.PDFDocument.load(ab);
            const pages = await currentDoc.copyPages(newDoc, newDoc.getPageIndices());
            pages.forEach(p=>currentDoc.addPage(p));
          }
          await this.updateDocs(currentDoc);
          DOM.initialMessage.classList.add('hidden');
          UI.showModal(`${files.length} arquivo(s) processado(s) com sucesso!`);
        }catch(err){ console.error(err); UI.showModal('Erro ao processar o PDF. Verifique se o arquivo é válido.'); }
        finally{ UI.hideLoading(); }
      },
      async rotatePages(angle){
        if(!appState.selectedPageIndices.length) return UI.showModal('Selecione as páginas para girar.');
        UI.showLoading('Girando páginas...');
        appState.selectedPageIndices.forEach(i=>{
          const page = appState.pdfDocLib.getPage(i);
          const r = page.getRotation().angle; page.setRotation(PDFLib.degrees(r+angle));
        });
        await this.updateDocs(appState.pdfDocLib);
        UI.hideLoading(); UI.showModal('Páginas giradas com sucesso!');
      },
      async removePages(){
        if(!appState.selectedPageIndices.length) return UI.showModal('Selecione as páginas para remover.');
        UI.showLoading('Removendo páginas...');
        [...appState.selectedPageIndices].sort((a,b)=>b-a).forEach(i=>appState.pdfDocLib.removePage(i));
        await this.updateDocs(appState.pdfDocLib);
        UI.hideLoading(); UI.showModal('Páginas removidas com sucesso!');
      },
      async split(){
        if(!appState.selectedPageIndices.length) return UI.showModal('Selecione as páginas para criar um novo PDF.');
        UI.showLoading('Criando novo PDF...');
        const newDoc = await PDFLib.PDFDocument.create();
        const copy = await newDoc.copyPages(appState.pdfDocLib, [...appState.selectedPageIndices].sort((a,b)=>a-b));
        copy.forEach(p=>newDoc.addPage(p));
        const bytes = await newDoc.save();
        this.download(bytes,'pdf_dividido.pdf');
        UI.hideLoading(); UI.showModal('Novo PDF criado com sucesso!');
      },
      async replacePage(){
        if(appState.selectedPageIndices.length!==1) return UI.showModal('Selecione exatamente uma página para substituir.');
        const input = document.createElement('input'); input.type='file'; input.accept='.pdf';
        input.onchange = async (e)=>{
          const file = e.target.files[0]; if(!file) return; UI.showLoading('Substituindo página...');
          try{
            const idx = appState.selectedPageIndices[0];
            const rep = await PDFLib.PDFDocument.load(await file.arrayBuffer());
            const [page] = await appState.pdfDocLib.copyPages(rep,[0]);
            appState.pdfDocLib.removePage(idx); appState.pdfDocLib.insertPage(idx,page);
            await this.updateDocs(appState.pdfDocLib); UI.showModal('Página substituída com sucesso!');
          }catch(err){ console.error(err); UI.showModal('Erro ao substituir a página.'); }
          finally{ UI.hideLoading(); }
        };
        input.click();
      },
      download(bytes, defaultName){
        const blob = new Blob([bytes],{type:'application/pdf'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        let name = DOM.fileNameInput.value.trim() || defaultName; if(!name.toLowerCase().endsWith('.pdf')) name += '.pdf';
        a.href = url; a.download = name; document.body.appendChild(a); a.click(); document.body.removeChild(a);
        setTimeout(()=>URL.revokeObjectURL(url),0);
      },
      async save(){ if(!appState.pdfDocLib) return UI.showModal('Nenhum PDF carregado para salvar.'); UI.showLoading('Gerando PDF...'); const bytes = await appState.pdfDocLib.save(); this.download(bytes,'pdf_editado.pdf'); UI.hideLoading(); UI.showModal('PDF salvo com sucesso!'); }
    };

    // Eventos
    const EventHandlers = {
      preventDefaults(e){ e.preventDefault(); e.stopPropagation(); },
      onPageClick(e){ const el = e.currentTarget; const idx = +el.dataset.index; const i = appState.selectedPageIndices.indexOf(idx); if(i>-1){appState.selectedPageIndices.splice(i,1); el.classList.remove('selected');} else {appState.selectedPageIndices.push(idx); el.classList.add('selected');} UI.updateButtonStates(); },
      onDragStart(e){ const el=e.target.closest('.pdf-page'); appState.draggedPageIndex=+el.dataset.index; el.classList.add('dragging'); e.dataTransfer.effectAllowed='move'; },
      onDragOver(e){ e.preventDefault(); e.dataTransfer.dropEffect='move'; e.target.closest('.pdf-page')?.classList.add('drag-over'); },
      onDragLeave(e){ e.target.closest('.pdf-page')?.classList.remove('drag-over'); },
      async onDropOnPage(e){
        e.preventDefault(); const target=e.target.closest('.pdf-page'); target?.classList.remove('drag-over'); const targetIndex=+target.dataset.index;
        if(Number.isInteger(appState.draggedPageIndex) && Number.isInteger(targetIndex) && appState.draggedPageIndex!==targetIndex){
          UI.showLoading('Reordenando páginas...');
          const [moved] = await appState.pdfDocLib.copyPages(appState.pdfDocLib,[appState.draggedPageIndex]);
          appState.pdfDocLib.removePage(appState.draggedPageIndex);
          let insertAt = targetIndex; if(appState.draggedPageIndex < targetIndex) insertAt = targetIndex - 1; // **ajuste de índice**
          appState.pdfDocLib.insertPage(insertAt, moved);
          await PDF.updateDocs(appState.pdfDocLib); UI.hideLoading();
        }
      },
      onDragEnd(e){ e.target.closest('.pdf-page').classList.remove('dragging'); appState.draggedPageIndex=null; },
      async onDropOnContainer(e){ DOM.pdfContainerWrapper.classList.remove('drop-zone-highlight'); const files = [...e.dataTransfer.files].filter(f=>f.type==='application/pdf'); if(!files.length) return UI.showModal('Por favor, solte apenas arquivos PDF válidos.'); await PDF.loadFiles(files); },
      setup(){
        DOM.importInput.addEventListener('change', (e)=>{ if(e.target.files.length) PDF.loadFiles([...e.target.files]); e.target.value=''; });
        DOM.buttons.replace.addEventListener('click', PDF.replacePage);
        DOM.buttons.rotateClockwise.addEventListener('click', ()=>PDF.rotatePages(90));
        DOM.buttons.rotateCounterClockwise.addEventListener('click', ()=>PDF.rotatePages(-90));
        DOM.buttons.remove.addEventListener('click', PDF.removePages);
        DOM.buttons.split.addEventListener('click', PDF.split);
        DOM.buttons.download.addEventListener('click', PDF.save);

        // Modal: fechar com Esc/overlay
        DOM.modal.container.addEventListener('click', (e)=>{ if(e.target===DOM.modal.container) UI.hideModal(); });
        document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') UI.hideModal(); });
        DOM.modal.closeButton.addEventListener('click', UI.hideModal);

        // Tema
        DOM.themeToggle.addEventListener('click', ()=>{ DOM.htmlEl.classList.toggle('dark'); const isDark=DOM.htmlEl.classList.contains('dark'); localStorage.setItem('theme', isDark?'dark':'light'); DOM.themeToggle.innerHTML=isDark?'☀️':'🌙'; });

        // DnD
        ['dragenter','dragover','dragleave','drop'].forEach(evt=>document.body.addEventListener(evt, this.preventDefaults, false));
        DOM.pdfContainerWrapper.addEventListener('dragenter', ()=>DOM.pdfContainerWrapper.classList.add('drop-zone-highlight'));
        DOM.pdfContainerWrapper.addEventListener('dragleave', ()=>DOM.pdfContainerWrapper.classList.remove('drop-zone-highlight'));
        DOM.pdfContainerWrapper.addEventListener('drop', this.onDropOnContainer);

        // Logo
        DOM.changeLogoBtn.addEventListener('click', ()=>DOM.logoInput.click());
        DOM.clearLogoBtn.addEventListener('click', ()=>{ localStorage.removeItem('appLogoData'); DOM.logoImg.src='https://placehold.co/56x56/4f46e5/ffffff?text=LOGO'; DOM.favicon.href = DOM.logoImg.src; });
        DOM.logoInput.addEventListener('change', async (e)=>{
          const file = e.target.files?.[0]; if(!file) return; const dataUrl = await fileToDataURL(file);
          DOM.logoImg.src = dataUrl; localStorage.setItem('appLogoData', dataUrl); DOM.favicon.href = dataUrl;
        });
      }
    };

    // Utils
    function fileToDataURL(file){ return new Promise((res,rej)=>{ const r=new FileReader(); r.onload=()=>res(r.result); r.onerror=rej; r.readAsDataURL(file); }); }
    function restoreLogo(){ const saved = localStorage.getItem('appLogoData'); if(saved){ DOM.logoImg.src = saved; DOM.favicon.href = saved; } }

    // Boot
    document.addEventListener('DOMContentLoaded', ()=>{ UI.updateButtonStates(); UI.loadTheme(); UI.setSignature(); restoreLogo(); EventHandlers.setup(); });
  </script>
</body>
</html>
```

---

## Como usar o logo

* Clique em **Trocar logo** e selecione sua imagem (`.png`, `.jpg` ou `.svg`).
* O logo fica salvo em **localStorage** e volta automaticamente quando você reabrir a página.
* **Remover logo** volta para o placeholder.
* Também aplico o logo como **favicon** da aba.

Se quiser, posso adaptar para **dois logos** (claro/escuro) e alternar conforme o tema. Basta me mandar os arquivos e eu acoplo no código.
